# NewsPub Docker æ„å»ºä¼˜åŒ–æŒ‡å—

æœ¬é¡¹ç›®å·²é…ç½®é˜¿é‡Œäº‘ Maven ä»“åº“ï¼Œå¤§å¹…æå‡ä¾èµ–ä¸‹è½½é€Ÿåº¦å’Œæ„å»ºæ•ˆç‡ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ä¸€é”®æ„å»ºå’Œå¯åŠ¨
```bash
./build.sh
```

### 2. ä»…æ„å»ºé•œåƒ
```bash
docker-compose build
```

### 3. å¯åŠ¨æœåŠ¡
```bash
docker-compose up -d
```

## ğŸ“¦ Maven ä»“åº“é…ç½®

### é˜¿é‡Œäº‘ä»“åº“åœ°å€
- **Central**: https://maven.aliyun.com/repository/central
- **Public**: https://maven.aliyun.com/repository/public  
- **Spring**: https://maven.aliyun.com/repository/spring
- **Spring Plugin**: https://maven.aliyun.com/repository/spring-plugin

### é…ç½®æ–‡ä»¶è¯´æ˜
- `.mvn/settings.xml` - Docker æ„å»ºæ—¶ä½¿ç”¨çš„ Maven é…ç½®
- `settings-local.xml` - æœ¬åœ°å¼€å‘æ—¶ä½¿ç”¨çš„ Maven é…ç½®
- `pom.xml` - é¡¹ç›®ä¸­å·²æ·»åŠ é˜¿é‡Œäº‘ä»“åº“é…ç½®

## ğŸ”§ æœ¬åœ°å¼€å‘

### ä½¿ç”¨é˜¿é‡Œäº‘ä»“åº“è¿›è¡Œæœ¬åœ°æ„å»º
```bash
# ä½¿ç”¨æœ¬åœ°é…ç½®æ–‡ä»¶
mvn clean package -s settings-local.xml -DskipTests -P jar

# æˆ–è€…ç›´æ¥ä½¿ç”¨ï¼ˆpom.xml ä¸­å·²é…ç½®ï¼‰
mvn clean package -DskipTests -P jar
```

### æµ‹è¯• Maven é…ç½®
```bash
./test-maven.sh
```

## ğŸ³ Docker æ„å»ºä¼˜åŒ–

### å¤šé˜¶æ®µæ„å»ºæµç¨‹
1. **ä¾èµ–é˜¶æ®µ**: åªå¤åˆ¶ `pom.xml` å’Œ Maven é…ç½®ï¼Œä¸‹è½½æ‰€æœ‰ä¾èµ–
2. **æ„å»ºé˜¶æ®µ**: å¤åˆ¶æºä»£ç ï¼Œä½¿ç”¨ç¼“å­˜çš„ä¾èµ–è¿›è¡Œç¼–è¯‘
3. **è¿è¡Œé˜¶æ®µ**: åˆ›å»ºè½»é‡çº§è¿è¡Œæ—¶é•œåƒ

### ç¼“å­˜ä¼˜åŒ–ç­–ç•¥
- ä¾èµ–ä¸‹è½½å’Œä»£ç ç¼–è¯‘åˆ†ç¦»
- åªæœ‰ `pom.xml` å˜åŒ–æ—¶æ‰é‡æ–°ä¸‹è½½ä¾èµ–
- ä»£ç å˜åŒ–æ—¶åªé‡æ–°ç¼–è¯‘ï¼Œä¸é‡æ–°ä¸‹è½½ä¾èµ–
- ä½¿ç”¨ Docker BuildKit æå‡æ„å»ºæ€§èƒ½

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| åœºæ™¯ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| é¦–æ¬¡æ„å»º | 5-10åˆ†é’Ÿ | 3-5åˆ†é’Ÿ | 40-50% |
| ä»£ç å˜æ›´æ„å»º | 5-10åˆ†é’Ÿ | 30-60ç§’ | 90%+ |
| ä¾èµ–ä¸‹è½½é€Ÿåº¦ | è¾ƒæ…¢ï¼ˆå›½å¤–æºï¼‰ | å¿«é€Ÿï¼ˆé˜¿é‡Œäº‘ï¼‰ | 3-5å€ |

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### æ„å»ºç›¸å…³
```bash
# å®Œæ•´æ„å»º
./build.sh

# å¼ºåˆ¶é‡æ–°æ„å»ºï¼ˆä¸ä½¿ç”¨ç¼“å­˜ï¼‰
docker-compose build --no-cache

# åªæ„å»ºåº”ç”¨é•œåƒ
docker-compose build news-app

# æŸ¥çœ‹æ„å»ºæ—¥å¿—
docker-compose logs news-app
```

### æœåŠ¡ç®¡ç†
```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# åœæ­¢æœåŠ¡
docker-compose down

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f news-app
```

### æ¸…ç†ç›¸å…³
```bash
# æ¸…ç†æ„å»ºç¼“å­˜
docker builder prune

# æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ
docker image prune

# å®Œå…¨æ¸…ç†ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
docker system prune -a
```

## ğŸŒ è®¿é—®åœ°å€

æœåŠ¡å¯åŠ¨åå¯é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **å‰å°**: http://localhost:8080
- **åå°**: http://localhost:8080/cp
  - ç”¨æˆ·å: `admin`
  - å¯†ç : `password`
- **APIæ–‡æ¡£**: http://localhost:8080/swagger-ui/index.html

## ğŸ” æ•…éšœæ’é™¤

### æ„å»ºå¤±è´¥
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ¸…ç† Docker ç¼“å­˜: `docker builder prune`
3. é‡æ–°æ„å»º: `docker-compose build --no-cache`

### ä¾èµ–ä¸‹è½½æ…¢
1. ç¡®è®¤ä½¿ç”¨äº†é˜¿é‡Œäº‘ä»“åº“é…ç½®
2. æ£€æŸ¥ `.mvn/settings.xml` æ–‡ä»¶
3. è¿è¡Œæµ‹è¯•è„šæœ¬: `./test-maven.sh`

### æœåŠ¡å¯åŠ¨å¤±è´¥
1. æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®
2. æŸ¥çœ‹æœåŠ¡æ—¥å¿—: `docker-compose logs news-app`
3. ç¡®è®¤ç«¯å£æœªè¢«å ç”¨

## ğŸ“ æ³¨æ„äº‹é¡¹

1. é¦–æ¬¡æ„å»ºä»éœ€è¦ä¸‹è½½æ‰€æœ‰ä¾èµ–ï¼Œè¯·è€å¿ƒç­‰å¾…
2. åç»­æ„å»ºä¼šåˆ©ç”¨ç¼“å­˜ï¼Œé€Ÿåº¦ä¼šæ˜¾è‘—æå‡
3. ä¿®æ”¹ `pom.xml` åä¼šé‡æ–°ä¸‹è½½ä¾èµ–
4. å»ºè®®å®šæœŸæ¸…ç† Docker ç¼“å­˜ä»¥é‡Šæ”¾ç£ç›˜ç©ºé—´
